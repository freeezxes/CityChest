(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2578:function(e,s,t){Promise.resolve().then(t.bind(t,3813))},3813:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Q}});var a=t(7437),r=t(2265),l=t(1994),i=t(3335);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,i.m6)((0,l.W)(s))}function c(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:n("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function d(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:n("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function o(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:n("leading-none font-semibold",s),...t})}function x(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:n("px-6",s),...t})}var m=t(5293),h=t(535);let u=(0,h.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function g(e){let{className:s,variant:t,size:r,asChild:l=!1,...i}=e,c=l?m.g7:"button";return(0,a.jsx)(c,{"data-slot":"button",className:n(u({variant:t,size:r,className:s})),...i})}let j=(0,h.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function b(e){let{className:s,variant:t,asChild:r=!1,...l}=e,i=r?m.g7:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:n(j({variant:t}),s),...l})}var f=t(814);function p(e){let{className:s,value:t,...r}=e;return(0,a.jsx)(f.fC,{"data-slot":"progress",className:n("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...r,children:(0,a.jsx)(f.z$,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}var N=t(9474),v=t(7404),w=t(7414),y=t(3774),k=t(6595),F=t(7877),C=t(3581),T=t(2660),Z=t(1239);function D(e){let{onScan:s,onBack:t,onSuccess:l}=e,[i,n]=(0,r.useState)(!1),[d,o]=(0,r.useState)(""),[m,h]=(0,r.useState)(!1),[u,j]=(0,r.useState)(null),b=(0,r.useRef)(null),f=[{id:"1",name:"Байтерек",location:"Астана"},{id:"3",name:"Медеу",location:"Алматы"},{id:"2",name:"Чарынский каньон",location:"Алматинская область"}],p=async e=>{h(!0);try{let s=await fetch("https://saint.kz/api/nfts/win/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});if(!s.ok)return console.error("[v0] Ошибка при получении NFT"),{id:e,name:"NFT Достопримечательность ".concat(e),description:"Тестовая NFT награда за посещение достопримечательности",rarity:"Редкая",image:"\uD83C\uDFC6"};{let e=await s.json();return console.log("[v0] NFT успешно получен:",e),e}}catch(s){return console.error("[v0] Ошибка сети:",s),{id:e,name:"NFT Достопримечательность ".concat(e),description:"Тестовая NFT награда за посещение достопримечательности",rarity:"Редкая",image:"\uD83C\uDFC6"}}finally{h(!1)}},N=async()=>{n(!0);try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});b.current&&(b.current.srcObject=e)}catch(e){console.error("Ошибка доступа к камере:",e),n(!1)}},w=()=>{var e;n(!1),(null===(e=b.current)||void 0===e?void 0:e.srcObject)&&b.current.srcObject.getTracks().forEach(e=>e.stop())},y=async e=>{o(e);let s=await p(e);s&&j(s)},k=()=>{if(!i||!b.current)return;console.log("Scanning for QR codes...");let e=setTimeout(()=>{let e=Math.floor(Math.random()*f.length);y(f[e].id),w()},3e3+2e3*Math.random());return()=>clearTimeout(e)};return(0,r.useEffect)(()=>{if(i){let e=setInterval(k,500);return()=>clearInterval(e)}},[i]),(0,r.useEffect)(()=>()=>{w()},[]),(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 to-purple-900 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-black/20",children:[(0,a.jsxs)(g,{variant:"ghost",onClick:t,className:"text-white",children:[(0,a.jsx)(T.Z,{className:"h-5 w-5 mr-2"}),"Назад"]}),(0,a.jsx)("h1",{className:"text-lg font-semibold",children:"QR Сканер"}),(0,a.jsx)("div",{})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"relative w-full max-w-sm aspect-square mb-6",children:i?(0,a.jsxs)("div",{className:"relative w-full h-full rounded-2xl overflow-hidden border-4 border-white/30",children:[(0,a.jsx)("video",{ref:b,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),(0,a.jsxs)("div",{className:"absolute inset-0 border-2 border-primary rounded-2xl",children:[(0,a.jsx)("div",{className:"absolute top-4 left-4 w-6 h-6 border-l-4 border-t-4 border-primary rounded-tl-lg"}),(0,a.jsx)("div",{className:"absolute top-4 right-4 w-6 h-6 border-r-4 border-t-4 border-primary rounded-tr-lg"}),(0,a.jsx)("div",{className:"absolute bottom-4 left-4 w-6 h-6 border-l-4 border-b-4 border-primary rounded-bl-lg"}),(0,a.jsx)("div",{className:"absolute bottom-4 right-4 w-6 h-6 border-r-4 border-b-4 border-primary rounded-br-lg"}),(0,a.jsx)("div",{className:"absolute inset-x-0 top-1/2 h-0.5 bg-primary shimmer"})]})]}):(0,a.jsx)("div",{className:"w-full h-full rounded-2xl border-4 border-dashed border-white/30 flex items-center justify-center",children:(0,a.jsx)(v.Z,{className:"h-20 w-20 text-white/50"})})}),(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:i?"Наведите на QR код":"Сканируйте QR код достопримечательности"}),(0,a.jsx)("p",{className:"text-white/70",children:i?"Убедитесь, что QR код четко виден в рамке":"Нажмите кнопку ниже, чтобы начать сканирование"})]}),!i&&(0,a.jsxs)(g,{onClick:N,className:"bg-primary hover:bg-primary/90 text-primary-foreground px-8 py-3 text-lg pulse-glow",children:[(0,a.jsx)(Z.Z,{className:"h-5 w-5 mr-2"}),"Начать сканирование"]}),i&&(0,a.jsx)(g,{onClick:w,variant:"secondary",className:"px-8 py-3",children:"Остановить"}),(0,a.jsxs)("div",{className:"w-full max-w-sm mt-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Демо QR коды для тестирования:"}),(0,a.jsx)("div",{className:"space-y-3",children:f.map(e=>(0,a.jsx)(c,{className:"bg-white/10 border-white/20",children:(0,a.jsx)(x,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-white/70",children:e.location})]}),(0,a.jsx)(g,{onClick:()=>y(e.id),size:"sm",className:"bg-secondary hover:bg-secondary/90 text-secondary-foreground",children:"Сканировать"})]})})},e.id))})]}),d&&m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)(c,{className:"bg-white text-black bounce-in",children:(0,a.jsxs)(x,{className:"p-6 text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"⏳"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"QR код отсканирован!"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Отправляем данные на сервер..."})]})})}),d&&!m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)(c,{className:"bg-white text-black bounce-in max-w-sm w-full",children:(0,a.jsxs)(x,{className:"p-6 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF89"}),(0,a.jsx)("h3",{className:"text-xl font-bold mb-2 text-green-600",children:"Успех!"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Вы успешно отсканировали QR код и получили NFT награду!"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(g,{onClick:()=>{l(u||{id:d,name:"bayterek"===d?"Золотой Байтерек":"medeu"===d?"Ледяная корона Медеу":"Дух каньона",description:"Уникальная NFT награда за посещение достопримечательности Казахстана",rarity:"Редкая",image:"bayterek"===d?"\uD83C\uDFD7️":"medeu"===d?"⛸️":"\uD83C\uDFD4️"})},className:"w-full bg-primary hover:bg-primary/90",children:"Забрать награду"}),(0,a.jsx)(g,{onClick:()=>o(""),variant:"outline",className:"w-full",children:"Сканировать еще"})]})]})})})]})]})}let S={"Золотой Байтерек":{image:"/placeholder-xpbyo.png",rarity:"Легендарный",description:"Символ современного Казахстана в золотом исполнении",power:95},"Ледяная корона Медеу":{image:"/placeholder-nsmjn.png",rarity:"Эпический",description:"Корона высокогорного катка мирового класса",power:85},"Дух каньона":{image:"/placeholder-rnnuy.png",rarity:"Редкий",description:"Мистический дух величественного каньона",power:75}},M=e=>{switch(e){case"Легендарный":return"bg-gradient-to-r from-yellow-400 to-orange-500";case"Эпический":return"bg-gradient-to-r from-purple-400 to-pink-500";case"Редкий":return"bg-gradient-to-r from-blue-400 to-cyan-500";default:return"bg-gradient-to-r from-gray-400 to-gray-500"}};function z(e){let{nfts:s,onBack:t}=e,r=s.reduce((e,s)=>{let t=S[s];return e+((null==t?void 0:t.power)||0)},0);return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-black/20",children:[(0,a.jsxs)(g,{variant:"ghost",onClick:t,className:"text-white",children:[(0,a.jsx)(T.Z,{className:"h-5 w-5 mr-2"}),"Назад"]}),(0,a.jsx)("h1",{className:"text-lg font-semibold",children:"Моя коллекция NFT"}),(0,a.jsx)("div",{})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,a.jsx)(c,{className:"bg-white/10 border-white/20 text-center",children:(0,a.jsxs)(x,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-secondary",children:s.length}),(0,a.jsx)("div",{className:"text-sm text-white/70",children:"Собрано NFT"})]})}),(0,a.jsx)(c,{className:"bg-white/10 border-white/20 text-center",children:(0,a.jsxs)(x,{className:"pt-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-primary",children:r}),(0,a.jsx)("div",{className:"text-sm text-white/70",children:"Общая сила"})]})}),(0,a.jsx)(c,{className:"bg-white/10 border-white/20 text-center",children:(0,a.jsxs)(x,{className:"pt-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-400",children:[Math.round(s.length/Object.keys(S).length*100),"%"]}),(0,a.jsx)("div",{className:"text-sm text-white/70",children:"Завершено"})]})})]}),0===s.length?(0,a.jsx)(c,{className:"bg-white/10 border-white/20",children:(0,a.jsxs)(x,{className:"p-8 text-center",children:[(0,a.jsx)(w.Z,{className:"h-16 w-16 text-white/50 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Коллекция пуста"}),(0,a.jsx)("p",{className:"text-white/70 mb-4",children:"Начните сканировать QR коды достопримечательностей, чтобы собрать уникальные NFT!"}),(0,a.jsx)(g,{onClick:t,className:"bg-primary hover:bg-primary/90",children:"Начать исследование"})]})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map((e,s)=>{let t=S[e];return t?(0,a.jsxs)(c,{className:"bg-white/10 border-white/20 overflow-hidden bounce-in",children:[(0,a.jsx)("div",{className:"h-2 ".concat(M(t.rarity))}),(0,a.jsx)(d,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o,{className:"text-white text-lg",children:e}),(0,a.jsx)(b,{className:"".concat(M(t.rarity)," text-white border-0"),children:t.rarity})]})}),(0,a.jsxs)(x,{children:[(0,a.jsx)("div",{className:"aspect-square mb-4 rounded-lg overflow-hidden bg-white/5",children:(0,a.jsx)("img",{src:t.image||"/placeholder.svg",alt:e,className:"w-full h-full object-cover"})}),(0,a.jsx)("p",{className:"text-white/80 text-sm mb-3",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(k.Z,{className:"h-4 w-4 text-yellow-400"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:["Сила: ",t.power]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs text-white/60",children:[(0,a.jsx)(N.Z,{className:"h-3 w-3"}),"Уникальный"]})]})]})]},s):null})}),(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5"}),"Доступные для сбора"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(S).map(e=>{let[t,r]=e,l=s.includes(t);return(0,a.jsx)(c,{className:"border-white/20 ".concat(l?"bg-green-900/20":"bg-white/5"),children:(0,a.jsx)(x,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-lg overflow-hidden ".concat(l?"":"grayscale opacity-50"),children:(0,a.jsx)("img",{src:r.image||"/placeholder.svg",alt:t,className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold ".concat(l?"text-green-400":"text-white/70"),children:t}),(0,a.jsx)(b,{className:"".concat(M(r.rarity)," text-white border-0 text-xs"),children:r.rarity}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)(k.Z,{className:"h-3 w-3 text-yellow-400"}),(0,a.jsxs)("span",{className:"text-xs",children:["Сила: ",r.power]})]})]}),(0,a.jsx)("div",{className:"text-right",children:l?(0,a.jsx)("div",{className:"text-green-400 text-sm font-medium",children:"✓ Собрано"}):(0,a.jsx)("div",{className:"text-white/50 text-sm",children:"Не собрано"})})]})})},t)})})]})]})]})}var R=t(2023);function E(e){let{reward:s,landmarkId:t,onOpen:l,onClose:i}=e,[n,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),h=async()=>{d(!0),setTimeout(async()=>{m(!0),d(!1),setTimeout(async()=>{await l(t)},2e3)},2e3)};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:(0,a.jsx)(c,{className:"bg-gradient-to-br from-purple-900 to-blue-900 border-2 border-yellow-400 max-w-sm w-full bounce-in",children:(0,a.jsx)(x,{className:"p-8 text-center text-white",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"inline-block p-4 rounded-full bg-gradient-to-r from-green-400 to-blue-500 bounce-in",children:(0,a.jsx)(k.Z,{className:"h-12 w-12 text-white"})})}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2 text-yellow-400",children:"Новый NFT получен!"}),(0,a.jsxs)("div",{className:"bg-white/10 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-yellow-400 mb-2",children:s}),(0,a.jsx)("p",{className:"text-white/80 text-sm",children:"Уникальный NFT добавлен в вашу коллекцию!"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4 text-sm text-white/70",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(R.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Редкость: Высокая"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(k.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Уникальный"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"inline-block p-4 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 ".concat(n?"animate-spin":"pulse-glow"),children:(0,a.jsx)(w.Z,{className:"h-12 w-12 text-white"})})}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2",children:n?"Открываем лутбокс...":"Поздравляем!"}),(0,a.jsx)("p",{className:"text-white/80 mb-6",children:n?"Ваша награда готовится!":"Вы успешно посетили достопримечательность и получили лутбокс!"}),!n&&(0,a.jsxs)(g,{onClick:h,className:"bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white font-bold py-3 px-6 pulse-glow",children:[(0,a.jsx)(R.Z,{className:"h-5 w-5 mr-2"}),"Открыть лутбокс"]}),n&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})})})}var P=t(4938),O=t(8919);function _(e){let{nftData:s,onGoHome:t}=e,r=async()=>{console.log("Sharing NFT:",s.id)};return(0,a.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-sky-600 via-blue-700 to-amber-600 text-white z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"min-h-full flex flex-col items-center justify-center p-4 py-8",children:[(0,a.jsxs)("div",{className:"text-center mb-6 animate-bounce",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-amber-400 to-yellow-500 rounded-full flex items-center justify-center mb-3 mx-auto shadow-xl",children:(0,a.jsx)(N.Z,{className:"h-8 w-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold mb-2 bg-gradient-to-r from-amber-300 to-yellow-400 bg-clip-text text-transparent",children:"Поздравляем!"}),(0,a.jsx)("p",{className:"text-white/90 text-base",children:"Вы получили новую NFT награду!"})]}),(0,a.jsx)(c,{className:"w-full max-w-xs bg-white/15 backdrop-blur-md border-white/30 shadow-xl mb-6",children:(0,a.jsxs)(x,{className:"p-4",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)("div",{className:"w-full aspect-square bg-gradient-to-br from-amber-400 via-yellow-500 to-orange-500 rounded-lg flex items-center justify-center text-4xl shadow-lg",children:s.image}),(0,a.jsxs)("div",{className:"absolute -top-2 -right-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-2 py-1 rounded-full text-xs font-semibold flex items-center shadow-lg",children:[(0,a.jsx)(k.Z,{className:"h-3 w-3 mr-1"}),s.rarity]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-white mb-2",children:s.name}),(0,a.jsx)("p",{className:"text-white/80 text-sm mb-4 leading-relaxed",children:s.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"bg-white/10 rounded-lg p-2",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-amber-300",children:"+100"}),(0,a.jsx)("div",{className:"text-xs text-white/70",children:"Очки"})]}),(0,a.jsxs)("div",{className:"bg-white/10 rounded-lg p-2",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-blue-300",children:"1/50"}),(0,a.jsx)("div",{className:"text-xs text-white/70",children:"Коллекция"})]})]})]})]})}),(0,a.jsxs)("div",{className:"w-full max-w-xs space-y-3",children:[(0,a.jsxs)(g,{onClick:t,className:"w-full bg-gradient-to-r from-blue-600 to-sky-600 hover:from-blue-700 hover:to-sky-700 text-white py-3 text-base font-semibold shadow-lg transition-all duration-200",children:[(0,a.jsx)(P.Z,{className:"h-4 w-4 mr-2"}),"На главную"]}),(0,a.jsxs)(g,{onClick:r,variant:"outline",className:"w-full border-white/40 text-white hover:bg-white/15 py-3 bg-white/10 backdrop-blur-sm transition-all duration-200",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Поделиться NFT"]})]}),(0,a.jsx)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[...Array(12)].map((e,s)=>(0,a.jsx)("div",{className:"absolute animate-ping text-amber-300",style:{left:"".concat(10+80*Math.random(),"%"),top:"".concat(10+80*Math.random(),"%"),animationDelay:"".concat(3*Math.random(),"s"),animationDuration:"".concat(2+2*Math.random(),"s"),fontSize:"12px"},children:"⭐"},s))})]})})}let I=async e=>{try{let s=await fetch("https://saint.kz/api/nfts/win/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});if(s.ok)return await s.json();return console.error("Failed to win NFT:",await s.text()),null}catch(e){return console.error("Error calling NFT win endpoint:",e),null}};function Q(){let[e,s]=(0,r.useState)("home"),[t,l]=(0,r.useState)([]),[i,n]=(0,r.useState)([]),[m,h]=(0,r.useState)(!1),[u,j]=(0,r.useState)(""),[f,T]=(0,r.useState)(null),[Z,S]=(0,r.useState)(null),[M,R]=(0,r.useState)("loading"),[P,O]=(0,r.useState)([]),[Q,A]=(0,r.useState)("loading");(0,r.useEffect)(()=>{(async()=>{A("loading");try{let e=await fetch("https://saint.kz/api/attractions");if(!e.ok)throw Error("API responded with status: ".concat(e.status));let s=(await e.json()).map(e=>({id:e.id.toString(),name:e.name,nameRu:e.name,location:e.location,description:e.description,nftReward:"NFT ".concat(e.name),coordinates:{lat:parseFloat(e.lat),lng:parseFloat(e.lon)},visited:!1}));O(s),A("success")}catch(e){console.error("Failed to fetch landmarks:",e),O([]),A("error")}})()},[]);let B=async e=>{let s=P.find(s=>s.id===e);if(s&&!t.includes(s.id))try{let a=await fetch("https://saint.kz/api/nfts/win/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});a.ok?(l([...t,s.id]),j(s.nftReward),h(!0)):console.error("Failed to win NFT:",await a.text())}catch(e){console.error("Error calling NFT win endpoint:",e)}},V=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{T({lat:e.coords.latitude,lng:e.coords.longitude}),R("granted")},e=>{console.log("[v0] Геолокация недоступна, используем демо координаты"),T({lat:48.0196,lng:66.9237}),R("denied")}):(T({lat:48.0196,lng:66.9237}),R("denied"))};return((0,r.useEffect)(()=>{V()},[]),"success"===e&&Z)?(0,a.jsx)(_,{nftData:Z,onGoHome:()=>{s("home"),S(null)}}):"scanner"===e?(0,a.jsx)(D,{onScan:B,onBack:()=>s("home"),onSuccess:e=>{S({id:e.id||"",name:e.name||"NFT Награда",description:e.description||"Уникальная NFT награда за посещение достопримечательности Казахстана",rarity:e.rarity||"Редкая",image:e.image||"\uD83C\uDFC6"}),s("success")}}):"collection"===e?(0,a.jsx)(z,{nfts:i,onBack:()=>s("home")}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-yellow-50",children:[(0,a.jsx)("div",{className:"bg-primary text-primary-foreground p-4 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"CityChess"}),(0,a.jsx)("p",{className:"text-sm opacity-90",children:"\uD83C\uDDF0\uD83C\uDDFF Казахстан"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm",children:"NFT собрано"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:i.length})]})]})}),(0,a.jsxs)("div",{className:"p-4 space-y-6 pb-24",children:[(0,a.jsxs)(c,{className:"pulse-glow",children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center gap-2",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5 text-secondary"}),"Прогресс исследования"]})}),(0,a.jsx)(x,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Посещено достопримечательностей"}),(0,a.jsxs)("span",{children:[t.length,"/","loading"===Q?"...":P.length]})]}),(0,a.jsx)(p,{value:"loading"===Q?0:P.length>0?t.length/P.length*100:0,className:"h-2 ".concat("loading"===Q?"animate-pulse":"")}),"loading"===Q&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Загрузка данных..."}),"error"===Q&&(0,a.jsx)("p",{className:"text-xs text-red-500",children:"Ошибка загрузки данных"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(g,{onClick:()=>s("scanner"),className:"h-20 flex-col gap-2 bg-primary hover:bg-primary/90",children:[(0,a.jsx)(v.Z,{className:"h-8 w-8"}),(0,a.jsx)("span",{children:"Сканировать QR"})]}),(0,a.jsxs)(g,{onClick:()=>s("collection"),variant:"secondary",className:"h-20 flex-col gap-2",children:[(0,a.jsx)(w.Z,{className:"h-8 w-8"}),(0,a.jsx)("span",{children:"Моя коллекция"})]})]}),(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{children:(0,a.jsxs)(o,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.Z,{className:"h-5 w-5 text-primary"}),"Достопримечательности рядом"]})}),(0,a.jsxs)(x,{className:"space-y-4",children:["loading"===Q&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Загрузка достопримечательностей..."})]}),"error"===Q&&(0,a.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,a.jsx)("p",{children:"Не удалось загрузить достопримечательности."}),(0,a.jsx)(g,{variant:"outline",className:"mt-2",onClick:async()=>{A("loading");try{let e=await fetch("https://saint.kz/api/attractions");if(!e.ok)throw Error("API responded with status: ".concat(e.status));let s=(await e.json()).map(e=>({id:e.id.toString(),name:e.name,nameRu:e.name,location:e.location,description:e.description,nftReward:"NFT ".concat(e.name),coordinates:{lat:parseFloat(e.lat),lng:parseFloat(e.lon)},visited:!1}));O(s),A("success")}catch(e){console.error("Failed to fetch landmarks:",e),O([]),A("error")}},children:"Попробовать снова"})]}),"success"===Q&&0===P.length&&(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Нет доступных достопримечательностей"})}),"success"===Q&&P.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.nameRu}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.location}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.description})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[t.includes(e.id)?(0,a.jsxs)(b,{variant:"secondary",className:"bg-green-100 text-green-800",children:[(0,a.jsx)(k.Z,{className:"h-3 w-3 mr-1"}),"Посещено"]}):(0,a.jsxs)(b,{variant:"outline",children:[(0,a.jsx)(F.Z,{className:"h-3 w-3 mr-1"}),f?"denied"===M?"Демо режим":"".concat(q(f,e.coordinates).toFixed(1)," км"):"Определение..."]}),(0,a.jsxs)("div",{className:"text-xs text-center",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Награда:"}),(0,a.jsx)("div",{className:"font-medium text-slate-700",children:e.nftReward})]})]})]},e.id))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(c,{className:"text-center",children:(0,a.jsxs)(x,{className:"pt-6",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-primary",children:t.length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Посещено"})]})}),(0,a.jsx)(c,{className:"text-center",children:(0,a.jsxs)(x,{className:"pt-6",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-700",children:i.length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"NFT собрано"})]})}),(0,a.jsx)(c,{className:"text-center",children:(0,a.jsxs)(x,{className:"pt-6",children:["loading"===Q?(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 animate-pulse",children:"..."}):"error"===Q?(0,a.jsx)("div",{className:"text-2xl font-bold text-red-500",children:"--"}):P.length>0?(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(t.length/P.length*100),"%"]}):(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:"0%"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Завершено"})]})})]})]}),m&&t.length>0&&(0,a.jsx)(E,{reward:u,landmarkId:t[t.length-1],onOpen:I,onClose:()=>h(!1)}),(0,a.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-border p-4",children:(0,a.jsxs)("div",{className:"flex justify-around",children:[(0,a.jsxs)(g,{variant:"home"===e?"default":"ghost",onClick:()=>s("home"),className:"flex-col gap-1 h-auto py-2",children:[(0,a.jsx)(y.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-xs",children:"Главная"})]}),(0,a.jsxs)(g,{variant:"scanner"===e?"default":"ghost",onClick:()=>s("scanner"),className:"flex-col gap-1 h-auto py-2",children:[(0,a.jsx)(C.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-xs",children:"Сканер"})]}),(0,a.jsxs)(g,{variant:"collection"===e?"default":"ghost",onClick:()=>s("collection"),className:"flex-col gap-1 h-auto py-2",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-xs",children:"Коллекция"})]}),(0,a.jsxs)(g,{variant:"profile"===e?"default":"ghost",onClick:()=>s("profile"),className:"flex-col gap-1 h-auto py-2",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"text-xs",children:"Профиль"})]})]})})]})}let q=(e,s)=>{let t=(s.lat-e.lat)*Math.PI/180,a=(s.lng-e.lng)*Math.PI/180,r=Math.sin(t/2)*Math.sin(t/2)+Math.cos(e.lat*Math.PI/180)*Math.cos(s.lat*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6371}}},function(e){e.O(0,[975,971,117,744],function(){return e(e.s=2578)}),_N_E=e.O()}]);